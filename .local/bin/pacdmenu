#!/bin/bash

action=$(echo -e "Install Program\nRemove Program\nRemove Waste\nUpdate System" | dmenu -p "Software Manager: " -i)

case $action in
"Install Program")
	package=$(pacman -Si |
		awk '/^Name/{name=$3} /^Download Size/{ds=$4$5} /^Repo/{repo=$3} /^Description/{sub(/^.{18}/,"", $0); print name, "["ds"]", "("repo") =>", $0} ' |
		sort -d | dmenu -i -l 20 | awk '{print $1}')

	doas pacman -S --noconfirm "$package"
	notify-send "ğŸ˜ğŸŠ $package is installed âœ¨"
	;;
"Remove Program")
	package=$(pacman -Qi |
		awk '/^Name/{name=$3} /^Installed Size/{ds=$4$5} /^Repo/{repo=$3} /^Description/{sub(/^.{18}/,"", $0); print name, "["ds"] =>", $0} ' |
		sort -d | dmenu -i -l 25 | awk '{print $1}')
	doas pacman -Rns --noconfirm "$package"
	notify-send "ğŸ˜ˆ $package is removed ğŸ˜¥"
	;;
"Remove Waste")
	doas pacman -Rns "$(pacman -Qqtd)"
	notify-send "â˜ ï¸  Orphan packages deleted ğŸ˜µ"
	;;
"Update System")
	doas pacman -Syyu
	notify-send "âœ¨ğŸ‰ğŸ¥³ System Update Complete"
	;;
*)
	notify-send "ğŸ˜• No Option Selected"
	;;
esac
